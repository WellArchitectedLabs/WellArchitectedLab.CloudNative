apiVersion: v1
kind: Service
metadata:
  name: backend-gateway-lb-service
  namespace: istio-gateway
  labels:
    app: backend
    version: v1
spec:
  type: LoadBalancer
  selector:
    gateway.networking.k8s.io/gateway-name: dev-backend-gateway
  ports:
  - name: http
    protocol: TCP
    port: 80
    targetPort: 80
  # This is the only way available for today
  # With which we will be able to map load balancer to the very specific pods
  # Which are the ones who run the operations workloads (tainted with workload=operations:NoSchedule)
  # the local traffic policy, as opposed to the cluster policy, would configure the azure load balancer which is created implicitly by kube
  externalTrafficPolicy: Local